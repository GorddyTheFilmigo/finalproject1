<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Details - {{ project.name }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
    <div class="container mt-5">
        <h2>{{ project.name }}</h2>
        <p><strong>Client/Manager:</strong> {{ project.client or project.manager or 'N/A' }}</p>
        <p><strong>Status:</strong> {{ project.status }}</p>
        <p><strong>Due Date:</strong> {{ project.deadline or 'N/A' }}</p>
        <p><strong>Budget:</strong> ${{ "{:,.0f}".format(project.budget or 0) }}</p>
        <p><strong>Description:</strong> {{ project.description or 'N/A' }}</p>
        <p><strong>Team Members:</strong> {{ project.team_members|join(', ') or 'None' }}</p>

        <div class="mb-4">
            <h5>Progress</h5>
            <div class="progress" style="height: 20px;">
                <div class="progress-bar" role="progressbar" style="width: {{ project.progress }}%;" aria-valuenow="{{ project.progress }}" aria-valuemin="0" aria-valuemax="100">{{ project.progress }}%</div>
            </div>
        </div>

        <!-- Form to update progress -->
        <h5>Update Progress</h5>
        <form method="POST" action="{{ url_for('update_project_progress', project_id=project.id) }}">
            <div class="mb-3">
                <label for="progress" class="form-label">New Progress (%)</label>
                <input type="number" class="form-control" id="progress" name="progress" min="0" max="100" value="{{ project.progress }}" required>
            </div>
            <button type="submit" class="btn btn-primary">Update</button>
        </form>

        <!-- Tasks -->
        <h5 class="mt-4">Tasks</h5>
        <ul class="list-group">
            {% for t in tasks %}
            <li class="list-group-item">
                <strong>{{ t.title }}</strong> - Status: {{ t.status }} - Assigned to: {{ t.assigned_to }} - Deadline: {{ t.deadline or 'N/A' }}
            </li>
            {% endfor %}
        </ul>

        <!-- Form to add task -->
        <h5 class="mt-4">Add Task</h5>
        <form method="POST" action="{{ url_for('projects_add_task') }}">
            <input type="hidden" name="project_id" value="{{ project.id }}">
            <div class="mb-3">
                <label for="task_title" class="form-label">Title</label>
                <input type="text" class="form-control" id="task_title" name="task_title" required>
            </div>
            <div class="mb-3">
                <label for="assigned_to" class="form-label">Assigned To</label>
                <input type="text" class="form-control" id="assigned_to" name="assigned_to">
            </div>
            <div class="mb-3">
                <label for="task_deadline" class="form-label">Deadline (YYYY-MM-DD)</label>
                <input type="date" class="form-control" id="task_deadline" name="task_deadline">
            </div>
            <div class="mb-3">
                <label for="task_status" class="form-label">Status</label>
                <select class="form-select" id="task_status" name="status">
                    <option value="Open">Open</option>
                    <option value="In Progress">In Progress</option>
                    <option value="Completed">Completed</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary">Add Task</button>
        </form>
    </div>
</body>
</html>